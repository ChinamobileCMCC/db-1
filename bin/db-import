#!/usr/bin/env sh

bin=$(dirname "$0")
. "${bin}/include/all"

if [ ! -e "${file}" ]; then
  snapshot="${3}"
  find_snapshot_from_any_server "${snapshot}"
fi


if [ -z "${file}" ]; then
  echo "USAGE: db import [server shortname] [<path to .sql or .sql.gz file> | <hash>]"
  exit 1
fi

connection_details="--defaults-extra-file=${connection_config}"
database=$(cat "${database_file}")

# include functions to restore full snapshot and to restore individual tables
. "${bin}/drivers/${databasetype}/connectors/${connectiontype}/restore"


if [ -f "${file}" ]; then
  echo "${colored_shortname}Starting import"

  restore_snapshot

  echo "${colored_shortname}Imported ${COLOR_LIGHT_BLUE}${file}${COLOR_NC}"
  exit 0
else
  echo "${colored_shortname}Cannot import ${COLOR_LIGHT_BLUE}${file}${COLOR_NC} - file does not exist"
  exit 1
fi
