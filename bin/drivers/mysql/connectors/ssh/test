#!/usr/bin/env sh

bin=$(dirname "$(python -c 'import os,sys;print(os.path.realpath(sys.argv[1]+"/../../../.."))' $0)")
. "${bin}/include/all"

connection_details="--defaults-extra-file=${connection_config}"

where=$(cat "${ssh_config}")
_user=$(cat "${connection_config}" | grep "^user" | cut -d '=' -f 2 | xargs)
_pass=$(cat "${connection_config}" | grep "^password" | cut -d '=' -f 2 | xargs)
_host=$(cat "${connection_config}" | grep "^host" | cut -d '=' -f 2 | xargs)
ssh ${where} "mysql --user=\"$_user\" --host=\"$_host\" --password=\"$_pass\" -e\"quit\" $database"
code=${?}

if [ "${code}" -eq 1 ]; then
  echo "${COLOR_RED}Could not connect to database.${COLOR_NC}"
else
  echo "${COLOR_GREEN}Successfully connected to database.${COLOR_NC}"
fi
exit ${code}